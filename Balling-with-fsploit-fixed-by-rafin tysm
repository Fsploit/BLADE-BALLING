local Stats = game:GetService('Stats')
local Players = game:GetService('Players')
local RunService = game:GetService('RunService')
local ReplicatedStorage = game:GetService('ReplicatedStorage')
local Nurysium_Util = loadstring(game:HttpGet('https://raw.githubusercontent.com/flezzpe/Nurysium/main/nurysium_helper.lua'))()

local local_player = Players.LocalPlayer
local camera = workspace.CurrentCamera
local nurysium_Data = nil
local hit_Sound = nil
local closest_Entity = nil
local parry_remote = nil

getgenv().aura_Enabled = false
getgenv().hit_sound_Enabled = false
getgenv().hit_effect_Enabled = false
getgenv().night_mode_Enabled = false
getgenv().trail_Enabled = false
getgenv().self_effect_Enabled = false

local Services = {
    game:GetService('AdService'),
    game:GetService('SocialService')
}

-- Shop Fractions
function SwordCrateManual()
    game:GetService("ReplicatedStorage").Remote.RemoteFunction:InvokeServer("PromptPurchaseCrate", workspace.Spawn.Crates.NormalSwordCrate)
end

function ExplosionCrateManual()
    game:GetService("ReplicatedStorage").Remote.RemoteFunction:InvokeServer("PromptPurchaseCrate", workspace.Spawn.Crates.NormalExplosionCrate)
end

function SwordCrateAuto()
    while _G.AutoSword do
        game:GetService("ReplicatedStorage").Remote.RemoteFunction:InvokeServer("PromptPurchaseCrate", workspace.Spawn.Crates.NormalSwordCrate)
        wait(1)
    end
end

function ExplosionCrateAuto()
    while _G.AutoBoom do
        game:GetService("ReplicatedStorage").Remote.RemoteFunction:InvokeServer("PromptPurchaseCrate", workspace.Spawn.Crates.NormalExplosionCrate)
        wait(1)
    end
end

-- Ui Library
local Library = loadstring(game:HttpGet("https://pastebin.com/raw/vff1bQ9F"))()
local Window = Library.CreateLib("Bedol Hub | re-make | Exploit X ", "Dark")
local Tab = Window:NewTab("Main")
local Tab2 = Window:NewTab("Misc")
local Tab3 = Window:NewTab("Visual")
local Tab4 = Window:NewTab("Credits")
local Combat = Tab:NewSection("Combat")
local Shop = Tab2:NewSection("Shop")
local Visual = Tab3:NewSection("Visual")
local Credits = Tab:NewSection("Made by fsploit. auto parry by aries TwT")
local Credits = Tab4:NewSection("Made By Fsploit or Dwimback69. On Discord")
local Credits = Tab4:NewSection("join our discord. discord.gg/exploitx")
local Credits1 = Tab4:NewSection("auto parry By Aries")
local Credits2 = Tab4:NewSection("Visual effect By nurysium")
local Credits3 = Tab4:NewSection("Delete Clash By Hosvile")

function initializate(dataFolder_name)
    local nurysium_Data = Instance.new('Folder', game:GetService('CoreGui'))
    nurysium_Data.Name = dataFolder_name
    hit_Sound = Instance.new('Sound', nurysium_Data)
    hit_Sound.SoundId = 'rbxassetid://8632670510'
    hit_Sound.Volume = 5
end

local function get_closest_entity(Object)
    task.spawn(function()
        local closest
        local max_distance = math.huge
        for index, entity in workspace.Alive:GetChildren() do
            if entity.Name ~= Players.LocalPlayer.Name then
                local distance = (Object.Position - entity.HumanoidRootPart.Position).Magnitude
                if distance < max_distance then
                    closest_Entity = entity
                    max_distance = distance
                end
            end
        end
        return closest_Entity
    end)
end

--// Thanks Aries for this.
function resolve_parry_Remote()
    for _, value in Services do
        local temp_remote = value:FindFirstChildOfClass('RemoteEvent')
        if not temp_remote then
            continue
        end
        if not temp_remote.Name:find('\n') then
            continue
        end
        parry_remote = temp_remote
    end
end

local aura_table = {
    canParry = true,
    is_Spamming = false,
    parry_Range = 0,
    spam_Range = 0,  
    hit_Count = 0,
    hit_Time = tick(),
    ball_Warping = tick(),
    is_ball_Warping = false
}

ReplicatedStorage.Remotes.ParrySuccess.OnClientEvent:Connect(function()
    if getgenv().hit_sound_Enabled then
        hit_Sound:Play()
    end
    if getgenv().hit_effect_Enabled then
        local hit_effect = game:GetObjects("rbxassetid://17407244385")[1]
        hit_effect.Parent = Nurysium_Util.getBall()
        hit_effect:Emit(3)
        task.delay(5, function()
            hit_effect:Destroy()
        end)
    end
end)

ReplicatedStorage.Remotes.ParrySuccessAll.OnClientEvent:Connect(function()
    aura_table.hit_Count += 1
    task.delay(0.15, function()
        aura_table.hit_Count -= 1
    end)
end)

workspace:WaitForChild("Balls").ChildRemoved:Connect(function(child)
    aura_table.hit_Count = 0
    aura_table.is_ball_Warping = false
    aura_table.is_Spamming = false
end)

Combat:NewToggle("Auto Parry", "Credit Avie Hub", function(toggled)
    resolve_parry_Remote()
    getgenv().aura_Enabled = toggled
end)

Visual:NewToggle("Kill mon Hit Sound", "ToggleInfo", function(toggled)
    getgenv().hit_sound_Enabled = toggled
end)

Combat:NewToggle("Hit Effect", "ToggleInfo", function(toggled)
    getgenv().hit_effect_Enabled = toggled
end)

Shop:NewButton("SwordCrate", "ButtonInfo", function()
    SwordCrateManual()
    print("Clicked")
end)

Shop:NewButton("ExplosionCrate", "ButtonInfo", function()
    ExplosionCrateManual()
    print("Clicked")
end)

Visual:NewToggle("Night/Day", "ToggleInfo", function(toggled)
    getgenv().night_mode_Enabled = toggled
end)

Visual:NewToggle("Trail", "ToggleInfo", function(toggled)
    getgenv().trail_Enabled = toggled
end)

Visual:NewToggle("no lag", "ToggleInfo", function(toggled)
    loadstring(game:HttpGet("https://raw.githubusercontent.com/Hosvile/Refinement/main/Destroy%20Particle%20Emitters",true))()
end)

Visual:NewToggle("Aiming Mechanism", "ToggleInfo", function(toggled)
    loadstring(game:HttpGet("https://raw.githubusercontent.com/Hosvile/Refinement/main/M%3ABlade%20Ball%20Mechanism",true))()
end)

--// trail
task.defer(function()
    game:GetService("RunService").Heartbeat:Connect(function()
        if not local_player.Character then
            return
        end
        if getgenv().trail_Enabled then
            local trail = game:GetObjects("rbxassetid://17483658369")[1]
            trail.Name = 'nurysium_fx'
            if local_player.Character.PrimaryPart:FindFirstChild('nurysium_fx') then
                return
            end
            local Attachment0 = Instance.new("Attachment", local_player.Character.PrimaryPart)
            local Attachment1 = Instance.new("Attachment", local_player.Character.PrimaryPart)
            Attachment0.Position = Vector3.new(0, -2.411, 0)
            Attachment1.Position = Vector3.new(0, 2.504, 0)
            trail.Parent = local_player.Character.PrimaryPart
            trail.Attachment0 = Attachment0
            trail.Attachment1 = Attachment1
        else
            if local_player.Character.PrimaryPart:FindFirstChild('nurysium_fx') then
                local_player.Character.PrimaryPart['nurysium_fx']:Destroy()
            end
        end
    end)
end)

--// night-mode
task.defer(function()
    while task.wait(1) do
        if getgenv().night_mode_Enabled then
            game:GetService("TweenService"):Create(game:GetService("Lighting"), TweenInfo.new(3), {ClockTime = 3.9}):Play()
        else
            game:GetService("TweenService"):Create(game:GetService("Lighting"), TweenInfo.new(3), {ClockTime = 13.5}):Play()
        end
    end
end)

--// aura
task.spawn(function()
    RunService.PreRender:Connect(function()
        if not getgenv().aura_Enabled then
            return
        end
        if closest_Entity then
            if workspace.Alive:Find
